<project name="genedb-util" default="fulljar" basedir=".">

	<dirname property="imported.basedir.util" file="${ant.file.genedb-util}"/>

    <path id="anttasks-jars">
        <filelist dir="${imported.basedir.util}/../genedb-libs/lib">
            <file name="spring-bundle-2.5.4/ant/ant.jar" />
        </filelist>
    </path>

	<target name="clean-build-util" >
		<delete dir="${imported.basedir.util}/ant-build" quiet="true"/>
	</target>

	<target name="setup-util" >
		<mkdir dir="${imported.basedir.util}/ant-build" />
		<mkdir dir="${imported.basedir.util}/ant-build/src" />
        <mkdir dir="${imported.basedir.util}/ant-build/anttasks" />
		<mkdir dir="${imported.basedir.util}/ant-build/classes" />
        <mkdir dir="${imported.basedir.util}/ant-build/anttasks-classes" />
		<mkdir dir="${imported.basedir.util}/ant-build/jars" />
	</target>

	<target name="fulljar" depends="clean-build-util,setup-util" description="Create full JAR file">

		<copy todir="${imported.basedir.util}/ant-build/src">
			<fileset dir="${imported.basedir.util}/src">
			    <include name="org/genedb/util/*.java"/>
			</fileset>
		</copy>

		<javac srcdir="${imported.basedir.util}/ant-build/src" destdir="${imported.basedir.util}/ant-build/classes" debug="on">
		    <classpath>
		        <pathelement location="${imported.basedir.util}/../genedb-libs/lib/biojava-1.6.jar"/>
		    </classpath>
		</javac>

		<jar jarfile="${imported.basedir.util}/ant-build/jars/genedb-util.jar">
			<fileset dir="${imported.basedir.util}/ant-build/classes" />
			<manifest>
				<attribute name="Implementation-Title" value="GeneDB Util"/>
				<attribute name="Implementation-Version" value="0.1"/>
			</manifest>
		</jar>
	</target>

    <target name="anttasks" depends="clean-build-util,setup-util" description="Create anttasks.jar">
        <copy todir="${imported.basedir.util}/ant-build/anttasks">
            <fileset dir="${imported.basedir.util}/anttasks">
                <include name="org/genedb/anttasks/*.java"/>
            </fileset>
        </copy>

        <javac srcdir="${imported.basedir.util}/ant-build/anttasks" destdir="${imported.basedir.util}/ant-build/anttasks-classes" debug="on">
            <classpath refid="anttasks-jars"/>
        </javac>

        <jar jarfile="${imported.basedir.util}/ant-build/jars/genedb-anttasks.jar">
            <fileset dir="${imported.basedir.util}/ant-build/anttasks-classes" />
            <manifest>
                <attribute name="Implementation-Title" value="GeneDB Ant tasks"/>
                <attribute name="Implementation-Version" value="0.1"/>
            </manifest>
        </jar>
    </target>

</project>
