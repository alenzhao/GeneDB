<project name="Jogra" default="fulljar-Jogra" basedir=".">

    <dirname property="imported.basedir.Jogra" file="${ant.file.Jogra}"/>

    <import file="../genedb-libs/build.xml"/>
    <import file="../genedb-db/build.xml"/>

    <property name="Jogra.jar" value="${imported.basedir.Jogra}/${dist.dir}/genedb-Jogra.jar"/>
    <property name="version" value="0.5"/>

    <path id="Jogra-classpath">
      <fileset dir="${imported.basedir.Jogra}/lib">
        <include name="*.jar"/>
      </fileset>
      <fileset dir="${imported.basedir.libs}/lib/gui">
        <include name="*.jar"/>
      </fileset>
      <pathelement location="${imported.basedir.libs}/lib/db/postgresql-8.3-603.jdbc4.jar"/>
      <pathelement location="${genedb-db.jar}"/>
    </path>

    <target name="init">
        <init project="Jogra" />
    </target>

    <target name="clean">
        <clean-target project="Jogra" />
    </target>

    <target name="jogra-compile" depends="clean, init, genedb-db.fulljar-db">
        <compile-target project="Jogra" />
        <copy todir="${imported.basedir.Jogra}/${classes.dir}">
            <fileset dir="${imported.basedir.Jogra}/conf"/>
        </copy>
    </target>

    <!-- create .jar -->
    <target name="fulljar-Jogra" depends="jogra-compile" description="Create an unsigned JAR">
        <pathconvert property="classpath-for-manifest" pathsep=" " refid="Jogra-classpath"/>
        <jar-target project="Jogra">
          <manifest>
            <attribute name="Implementation-Title" value="Jogra"/>
            <attribute name="Implementation-Version" value="${version}"/>
            <attribute name="Main-Class" value="org.genedb.jogra.drawing.Jogra"/>
            <attribute name="Class-Path" value="${classpath-for-manifest}"/>
          </manifest>
        </jar-target>
    </target>

    <target name="signed-jar-Jogra" depends="fulljar-Jogra" description="Create a signed JAR">
        <signjar jar="${imported.basedir.Jogra}/${dist.dir}/genedb-Jogra.jar"
            signedjar="${imported.basedir.Jogra}/${dist-dir}/Jogra-signed.jar"
            alias="Jogra" storepass="Jogra-pw"/>
    </target>

    <target name="run-Jogra" depends="fulljar-Jogra">
        <java fork="true" jar="${Jogra.jar}"/>
    </target>
  </project>